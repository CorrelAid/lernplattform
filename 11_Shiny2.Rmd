## Interaktive Visualisierungen

Was w√§re eine Welt ohne interaktive und zug√§ngliche Visualisierungen? Vielleicht habt Ihr es schon in den Online-Ausgaben von Zeitungen oder auch hier auf dieser Lernplattform gesehen und seid neugierig, wie man so etwas auch leicht selbst machen kann? Dann seid Ihr bei Shiny-Apps genau richtig! 

Im Video erfahrt Ihr, was es damit auf sich hat und wie es funktioniert.

![](VIDEO) (ca. 15 Minuten) 
*Notiz an mich: Slide mit Beispielen bringen; kurz Server und UI erkl√§ren*

Nina: hier vielleicht eine kleine Preview und m√ºndliche Erkl√§rung des Textes unten? 
**Cosima: genau das war der Plan :)**

# Kernaussagen 
-
-
-
-

# Was sind ShinyApps?

Wie Ihr im Video gesehen habt, sind Eurer Phantasie sind keine Grenzen gesetzt! Man kann Shiny-App zur Visualisierung, als Suchmaschine oder aber auch, um Euch automatisiert die Reports aus der letzten Sitzung erstellen zu lassen. In diesem Kurs lernt Ihr die Grundkenntnisse, um Eure erste eigene Anwendung (auf Englisch "application", daher auch "Shiny-App") zu bauen. Wenn Ihr mehr Inspiration m√∂chtet, schaut in der [Gallerie von RStudio](https://shiny.rstudio.com/gallery/) vorbei!

# Wie funktioniert eine Shiny-App genau? 

**Test - was ist Server, was ist UI**

Ihr habt meist zwei Dateien, eine `ui.R`-Datei und eine `server.R`-Datei, die Ihr dann mit `XXX` zusammenbringt. 

<center>![*Gehirn](daten/abbildungen/brain.png){#id .class width=15% height=15%}</center>

Eine `server.R` Datei kann so aussehen:

```{r server, eval = FALSE}

```

Die `server.R`-Datei erlaubt es Euch, das "Gehirn" der Shiny-App zu programmieren. 

<center>![*K√∂rper](daten/abbildungen/body.png){#id .class width=15% height=15%}</center>

Die `ui.R` kann zum Beispiel so aussehen:
```{r ui, eval = FALSE}

```


Eine `ui.R` Datei, die das *User Interface*, also die Benutzeroberfl√§che einer Shiny-App darstellt, erm√∂glicht es dem Nutzer die Shiny-App letztendlich zu bedienen. Im Video haben wir die `ui.R` Datei den "K√∂rper" genannt und die `server.R`-Datei das Gehirn. Genauso kann man es sich auch vorstellen: Im Gehirn, also der `server.R`-Datei, findet die gesamte Berechnung im Hintergrund statt. Die `ui.R`-Datei zeigt dann hinterher das Ergebnis an.

Ihr k√∂nnt in einer Shiny-App Eure bisherigen Kenntnisse anwenden. Nehmen wir einmal die Visualisierung aus der letzten Woche als Beispiel: 

![]() Abbildung einf√ºgen

Hier ist noch einmal der Code als Erinnerung daf√ºr:

```{r plot, eval = FALSE}
# Code Snippet
```

Wenn wir diese Abbildung in unsere Shiny-App integrieren wollen, k√∂nnen wir einfach den Code in unsere `server.R`-Datei kopieren und leicht anpassen. Aber machen wir das doch einmal zusammen. 

Was haben wir? 

1. *(Nutzer durchguiden) durch die Komponennt*
2. 
3. 

### Exkurs: Reaktives Programmieren - das Geheimnis einer Shiny-App

Das ganze Geheimnis hinter der App nennt sich *reactive programming*, oder auch *reaktives Programmieren*. Wie das funktioniert, k√∂nnt Ihr Euch in dem Video ansehen:

![](daten/abbildungen/reactivity.png)  (ca. 5 Minuten)
*Video zur Reaktivit√§t mit Brieftaube*

In K√ºrze: Man kann sich das Verhalten zwischen der UI, dem Server und dem Nutzer wie die Kommunikation mit einer Brieftaube vorstellen. Dieses sch√∂ne Bild stammt von Garrett Grolemund, der sagt, dass Reaktivit√§t eine Illusion erzeugt, die dem Nutzer vermittelt, dass die Nutzereingabe automatisch z.B. Abbildungen kreiert.^1  

**Quiz**

Wir haben letzte Woche den `select` Button kennen gelernt,

- Weitere Buttons/Auswahloptionen vorstellen

- Verweis auf letzte Sitzung?

**Quiz - zwei bis drei Buttons - oder ist das bl√∂d?**

- Weitere Aufgaben in der App

# Hosten von ShinyApps
RStudio bietet einen Hosting-Service f√ºr Eure Shiny-App an, den Ihr f√ºr kleinere Anwendungen kostenlos nutzen k√∂nnt: [ShinyApps.io](https://www.shinyapps.io). Eine dort gehostete Anwendung kann dann zum Beispiel [so aussehen](https://cosima-meyer.shinyapps.io/conflict-elections/) und, wie im Beispiel visuell, die Gewaltentwicklung vor Wahlen in Afghanistan darstellen. 

In jedem Fall sollte intern abgekl√§rt werden, ob diese Hosting-Option f√ºr Euch in Frage kommt oder ob es nicht eine alternative √ºber die IT-Abteilung gibt (z.B. bei sensiblen Daten).

Sollte die RStudio-L√∂sung f√ºr Euch eine Option sein, ist das Hosten denkbar einfach. Ihr m√ºsst nur die folgenden Schritte befolgen:

1. Alle Packages m√ºssen installiert sein und nur √ºber `library()` geladen werden. D.h. Euer Code darf kein `install.packages()` enthalten.
2. Dann m√ºsst Ihr `rsconnect` installieren (das macht Ihr ganz einfach √ºber die Console mit `install.packages("rsconnect")`)
3. Danach erstellt Ihr Euch einen Account auf [ShinyApps.io](https://www.shinyapps.io) (es gibt verschiedene Optionen, w√§hlt den aus, der am besten zu euren Bed√ºrfnissen passt)
4. Jetzt k√∂nnt Ihr `rsconnect` konfigurieren. Dazu m√ºsst Ihr den Token, den Euch [ShinyApps.io](https://www.shinyapps.io) zur Verf√ºgung stellt, kopieren. Die Screenshots zeigen Euch, wie Ihr dahin kommt.

Sobald Ihr Euch bei [ShinyApps.io](https://www.shinyapps.io)  eingeloggt habt, seht Ihr folgendes Dashboard: 

![](daten/abbildungen/shinyapps1.png)
Dort klickt Ihr auf Euer Benutzerkonto (rechts oben) und dann auf "Tokens" und gelangt zu folgendem Fenster:

![](daten/abbildungen/shinyapps2.png)

Wenn Ihr jetzt auf "+ Add Token" klickt, wird ein neues Token generiert und erscheint in der Auflistung. Um die Informationen zu bekommen, die Ihr f√ºr Eure Shiny-App braucht, klickt einfach auf "üëÅ Show". Dann √∂ffnet sich ein kleines Pop-up Fenster mit allen wichtigen Infos, die Ihr einfach kopieren k√∂nnt (klickt dazu auf "üìé Copy to clipboard").

![](daten/abbildungen/shinyapps3.png)

5. Nachdem Ihr den Code kopiert habt, verkn√ºpft Eure Shiny-App mit [ShinyApps.io](https://www.shinyapps.io), indem Ihr den Code in der Console einf√ºgt und ausf√ºhrt. 
6. Ihr k√∂nnt Eure Shiny-App noch vor dem finalen Deployen testen, indem Ihr in der Console `runApp()` ausf√ºhrt.
7. Hat alles geklappt? Dann kommt das Deployen! F√ºhrt in der Console einfach `deployApp()` aus und wartet ein bisschen - Eure Shiny-App ist nach ein bisschen Warten direkt online und kann √ºber einen Link aufgerufen werden!

# Und jetzt seid Ihr dran!
Ihr habt jetzt das wichtigste Grundwerkzeug gelernt, um eine Shiny-App lokal zu erstellen -- und genau das k√∂nnt Ihr in dieser √úbung mit euren Daten umsetzen! Ziel ist es, eine einfache Shiny-App zu erstellen. Dazu k√∂nnt Ihr beispielsweise eine Visualisierung aus einer vorherigen √úbung in eine Shiny-App einbinden oder eine Tabelle anzeigen lassen - eurer Phantasie sind keine Grenzen gesetzt! Jede Shiny-App f√§ngt simpel an und kann dann durch die einzelnen Bausteine beliebig erweitert werden. 
Hier die Schritte, die Ihr zum Erstellen einer Shiny-App befolgen solltet:

1. W√§hlt Euch eine Visualisierung (z.B. mit `ggplot2` oder aber auch mit `echarts4r`)  mit euren Daten aus (idealerweise habt Ihr schon Code, den Ihr jetzt einfach wieder benutzen k√∂nnt)
2. √ñffnet RStudio und erstellt ein neues Projekt. W√§hlt dort "ShinyApp" aus.  Gebt eurer Shiny-App einen geeigneten Namen. W√§hlt dort die Variante mit den separaten Dateien (jeweils eine Datei f√ºr die UI (`ui.R`) und eine Datei f√ºr den Server (`server.R`)) aus. **todo: nochmal schauen wie es genau hei√üt**
3. √úberlegt Euch, wie Eure Shiny-App aussehen soll. Eine Shiny-App hat meist links eine Seitenleiste mit Auswahlm√∂glichkeiten, in der Mitte (dem `main`-Part) ist meist Text, eine Visualisierung oder aber auch eine Tabelle. Es kann helfen, wenn Ihr Euch das kurz auf einem Papier visuell skizziert: Welche Visualisierung m√∂chtet Ihr in Eure Shiny-App einbinden? Was k√∂nnten Auswahlm√∂glichkeiten sein, die Ihr in der Seitenleiste ansteuern m√∂chtet? M√∂chtet Ihr Text als Informationen mitliefern?
4. Nehmt euren Code f√ºr die Visualisierung (wenn Ihr noch keinen Code habt erstellt zun√§chst eine Visualisierung mit `ggplot2` und nutzt diesen Code hier) und baut ihn in die `server.R`-Datei ein. Orientiert Euch hier an der Anleitung oben oder aber auch am [Schummelzettel]().
5. Im vorletzten Schritt versch√∂nern wir das Aussehen eurer App in der `ui.R`-Datei: Baut die einzelnen Auswahlm√∂glichkeiten in die Seitenleiste ein und platziert Eure Visualisierung oder euren Text im `main`-Part. 
6. Wenn Ihr m√∂chtet, k√∂nnt Ihr Eure Shiny-App √ºber ein `theme` noch weiter versch√∂nern. [Hier]() findet Ihr eine Liste an Auswahlm√∂glichkeiten. Um es umzusetzen **TBC**.
7. Und jetzt kommt der spannendste Part: Lasst Eure Shiny-App laufen! F√ºhrt dazu `shinyApp(ui = ui, server = server)` in der Console aus und probiert Eure Shiny-App aus!

Todo 

- Code zum Herunterladen implementieren
- Einfache Shiny-App
    1. Shiny-App zum Laufen bringen
    2. Kleinere Anpassungen (basierend auf dem anderen Kurs) vornehmen
    3. ?? 


- Ggf. Automatisierte Reports in der App als Ausblick??

**Nina: Da kannst du ganz flexibel sein - lass dich gerne von den Beispielen von learnR inspirieren!**


## Weitere Ressourcen
  - [R Studio tutorial](https://shiny.rstudio.com/tutorial/){target="_blank"}
  - [Hadley Wickham: Mastering Shiny](https://mastering-shiny.org){target="_blank"}
  - [Konstantin Gavras and Nick Baumann: Shiny Apps: Development and Deployment](https://www.mzes.uni-mannheim.de/socialsciencedatalab/article/shiny-apps/){target="_blank"} auf Methods Bites
  - [Julie Scholler: Intro to Shiny Web App](https://juliescholler.gitlab.io/files/M2/M2-CM3-Shiny.html#1){target="_blank"}
  - [Kaleen L. Medeiros: Introduction to Shiny](https://github.com/klmedeiros/rladies-tunisia-july2020-intro-shiny){target="_blank"}
  - [Garrett Grolemund: How to understand reactivity in R](https://shiny.rstudio.com/articles/understanding-reactivity.html){target="_blank"}
  - [CheatSheet](https://shiny.rstudio.com/images/shiny-cheatsheet.pdf){target="_blank"}
- ShinyApps hosten
  - [Hosting and deployment](https://shiny.rstudio.com/articles/shinyapps.html){target="_blank"}
  - [Shinyapps.io - Schritt f√ºr Schritt Anleitung (auf Englisch)](https://shiny.rstudio.com/articles/shinyapps.html){target="_blank"}
- echarts4r
  - [echarts4r vignette](https://echarts4r.john-coene.com/index.html){target="_blank"}
  - [Paul Simmering: Exploring echarts4r](https://rpubs.com/paul_simmering/echarts){target="_blank"}
  
- Value boxes
  - [Joshua Kunst: valueBoxes and Sparklines](https://jkunst.com/blog/posts/2020-06-26-valuebox-and-sparklines/){target="_blank"}

- Shiny dashboards
  - [R Studio tutorial](https://rstudio.github.io/shinydashboard/){target="_blank"}
  - [Themes](https://github.com/nik01010/dashboardthemes){target="_blank"}

- Optimieren von ShinyApps
  - [Make your Shiny-App faster](https://appsilon.com/r-shiny-faster-updateinput-css-javascript/){target="_blank"}
  - [shiny.worker](https://www.r-bloggers.com/shiny-worker-speed-up-r-shiny-apps-by-offloading-heavy-calculations/){target="_blank"}
  
[^1]: "Reactivity creates the illusion that changes in input values automatically flow to the plots, text, and tables that use the input‚Äîand cause them to update." (Garrett Grolemund) **LINK**